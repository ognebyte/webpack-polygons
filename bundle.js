(()=>{var t={16:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(601),s=n.n(r),o=n(314),i=n.n(o)()(s());i.push([t.id,'work-place {\n    flex: 1;\n    overflow: hidden;\n}\n\n.rulers-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    z-index: 10;\n}\n\n.ruler {\n    position: absolute;\n    background: var(--ruler-background-color);\n    font-size: 12px;\n    font-family: "Segoe UI", sans-serif;\n    color: var(--secondary-text-color);\n}\n\n.ruler-corner {\n    top: 0;\n    left: 0;\n    width: var(--ruler-size);\n    height: var(--ruler-size);\n    background: var(--background-color);\n}\n\n.ruler-x {\n    top: 0;\n    left: var(--ruler-size);\n    right: 0;\n    height: var(--ruler-size);\n    overflow: hidden;\n}\n\n.ruler-y {\n    top: var(--ruler-size);\n    left: 0;\n    width: var(--ruler-size);\n    bottom: 0;\n    overflow: hidden;\n}\n.ruler-tick {\n    position: absolute;\n    background: var(--grid-color);\n}\n\n.ruler-tick-x {\n    width: 1px;\n    height: var(--tick-size);\n    top: var(--tick-spacing);\n}\n\n.ruler-tick-y {\n    width: var(--tick-size);\n    height: 1px;\n    left: var(--tick-spacing);\n}\n\n.ruler-label {\n    position: absolute;\n}\n\n.ruler-label-x {\n    top: 2px;\n    margin-left: 3px;\n}\n\n.ruler-label-y {\n    left: 2px;\n    margin-bottom: 3px;\n    transform: rotate(-90deg);\n    transform-origin: left top;\n}\n\n.workplace {\n    position: absolute;\n    top: var(--ruler-size);\n    left: var(--ruler-size);\n    right: 0;\n    bottom: 0;\n    overflow: hidden;\n}\n\n.grid-pattern {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    color: var(--grid-color);\n    pointer-events: none;\n}\n\n.content-svg {\n    position: relative;\n}\n',""]);const a=i},56:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var o={},i=[],a=0;a<t.length;a++){var l=t[a],c=r.base?l[0]+r.base:l[0],d=o[c]||0,u="".concat(c," ").concat(d);o[c]=d+1;var h=n(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)e[h].references++,e[h].updater(p);else{var g=s(p,r);r.byIndex=a,e.splice(a,0,{identifier:u,updater:g,references:1})}i.push(u)}return i}function s(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,s){var o=r(t=t||[],s=s||{});return function(t){t=t||[];for(var i=0;i<o.length;i++){var a=n(o[i]);e[a].references--}for(var l=r(t,s),c=0;c<o.length;c++){var d=n(o[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}o=l}}},113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,r,s,o){"string"==typeof t&&(t=[[null,t,void 0]]);var i={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(i[l]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);r&&i[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),s&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=s):d[4]="".concat(s)),e.push(d))}},e}},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},583:()=>{class t extends HTMLElement{connectedCallback(){const t=this.querySelector("polygon");t&&!this.querySelector("svg")?this.measurePolygon(t).then(e=>this.wrapInSvg(t,e)):t?this.setup():this.render()}async measurePolygon(t){const e=this.createSVGElement("svg",{width:"0",height:"0",style:"position:absolute;opacity:0;pointer-events:none;z-index:-1"});return e.appendChild(t.cloneNode(!0)),document.body.appendChild(e),new Promise(t=>{requestAnimationFrame(()=>{const n=e.firstChild.getBBox();e.remove(),t(n)})})}createSVGElement(t,e={}){const n=document.createElementNS("http://www.w3.org/2000/svg",t);return Object.entries(e).forEach(([t,e])=>{"style"===t?n.style.cssText=e:n.setAttribute(t,e)}),n}wrapInSvg(t,e){const n=this.createSVGElement("svg",{width:e.width+10,height:e.height+10,viewBox:`${e.x-5} ${e.y-5} ${e.width+10} ${e.height+10}`});t.remove(),n.appendChild(t),this.appendChild(n),this.setup()}setup(){this.id||=`polygon-${crypto.randomUUID()}`,this.draggable=!0,this.classList.add("draggable"),this.addEventListener("dragstart",t=>t.dataTransfer.setData("text/plain",this.id))}render(){const{points:t,bbox:e}=this.generatePolygon();this.id=`polygon-${crypto.randomUUID()}`;const n=this.createSVGElement("svg",{width:e.width+10,height:e.height+10,viewBox:`${e.minX-5} ${e.minY-5} ${e.width+10} ${e.height+10}`}),r=this.createSVGElement("polygon",{points:t.map(t=>`${t.x},${t.y}`).join(" "),fill:randomColor(),stroke:"currentColor","stroke-width":"2"});n.appendChild(r),this.appendChild(n),this.setup()}generatePolygon(){const t=this.getRandomInt(4,8),e=this.getRandomInt(40,80),n=[];for(let r=0;r<t;r++){const s=2*Math.PI/t*r+.5*Math.random(),o=e*(.2+Math.random());n.push({x:o*Math.cos(s),y:o*Math.sin(s)})}return{points:n,bbox:this.getBoundingBox(n)}}getBoundingBox(t){const e=t.map(t=>t.x),n=t.map(t=>t.y),[r,s]=[Math.min(...e),Math.min(...n)],[o,i]=[Math.max(...e),Math.max(...n)];return{minX:r,minY:s,width:o-r,height:i-s}}getRandomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}}customElements.get("polygon-item")||customElements.define("polygon-item",t)},601:t=>{"use strict";t.exports=function(t){return t[1]}},659:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,s&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},870:()=>{class t extends HTMLElement{constructor(){super(),this.scale=1,this.isDragging=!1,this.startX=this.startY=0,this.offsetX=this.offsetY=0,this.dragDepth=0,this.gridSize=20}connectedCallback(){this.render(),this.loadPolygons(),this.setupEvents(),this.updateTransform()}getTranslateValue(t){const e=t.match(/translate\(([^,]+),\s*([^)]+)\)/);return e?[parseFloat(e[1]),parseFloat(e[2])]:[0,0]}getScaleValue(t){const e=t.match(/scale\(([^)]+)\)/);return e?parseFloat(e[1]):1}render(){this.innerHTML=`\n            <div class="rulers-container">\n                <div class="ruler ruler-corner"></div>\n                <div class="ruler ruler-x"></div>\n                <div class="ruler ruler-y"></div>\n            </div>\n            \n            <div class="workplace">\n                <svg class="grid-pattern" width="100%" height="100%">\n                    <defs>\n                        <pattern id="grid" width="${this.gridSize}" height="${this.gridSize}" patternUnits="userSpaceOnUse">\n                            <path d="M ${this.gridSize} 0 L 0 0 0 ${this.gridSize}" fill="none" stroke="currentColor" stroke-width="1"/>\n                        </pattern>\n                    </defs>\n                    <rect width="100%" height="100%" fill="url(#grid)" />\n                </svg>\n                \n                <svg class="content-svg" width="100%" height="100%">\n                    <g id="workplace-content"></g>\n                </svg>\n            </div>\n        `}loadPolygons=()=>{const t=this.querySelector("#workplace-content");if(!t)return;const e=localStorage.getItem("workplace-data");if(!e)return;const n=JSON.parse(e);t.innerHTML="",n.transform&&([this.offsetX,this.offsetY]=this.getTranslateValue(n.transform),this.scale=this.getScaleValue(n.transform)),n.polygons.forEach(e=>{const n=document.createElementNS("http://www.w3.org/2000/svg","polygon");n.setAttribute("points",e.points),n.setAttribute("fill",e.fill),n.setAttribute("transform",e.transform),n.setAttribute("data-id",e.dataId),n.setAttribute("stroke","currentColor"),n.setAttribute("stroke-width","2"),n.classList.add("draggable"),t.appendChild(n)})};setupEvents(){const t=this.querySelector(".workplace");t.addEventListener("dragenter",()=>{0===this.dragDepth++&&this.classList.add("dragenter")}),t.addEventListener("dragover",t=>t.preventDefault()),t.addEventListener("dragleave",()=>{--this.dragDepth<=0&&(this.dragDepth=0,this.classList.remove("dragenter"))}),t.addEventListener("drop",e=>{e.preventDefault(),this.dragDepth=0,this.classList.remove("dragenter");const n=e.dataTransfer.getData("text/plain"),r=document.getElementById(n),s=r?.querySelector("polygon");if(!s)return;r.remove();const o=this.createSVGElement("polygon");[...s.attributes].forEach(t=>o.setAttribute(t.name,t.value));const i=t.getBoundingClientRect(),a=(e.clientX-i.x-this.offsetX)/this.scale,l=(e.clientY-i.y-this.offsetY)/this.scale;o.dataset.id=n,o.classList.add("draggable"),o.setAttribute("transform",`translate(${a},${l})`),this.querySelector("#workplace-content").appendChild(o)}),t.addEventListener("wheel",e=>{e.preventDefault();const n=t.getBoundingClientRect(),r=e.clientX-n.x,s=e.clientY-n.y,o=(r-this.offsetX)/this.scale,i=(s-this.offsetY)/this.scale;this.scale=Math.min(Math.max(.2,this.scale-.001*e.deltaY),10),this.offsetX=r-o*this.scale,this.offsetY=s-i*this.scale,this.updateTransform()},{passive:!1}),t.addEventListener("mousedown",t=>{"polygon"===t.target.tagName?this.movePolygon(t):(this.isDragging=!0,[this.startX,this.startY]=[t.clientX,t.clientY])}),window.addEventListener("mousemove",t=>{this.isDragging&&(this.offsetX+=t.clientX-this.startX,this.offsetY+=t.clientY-this.startY,[this.startX,this.startY]=[t.clientX,t.clientY],this.updateTransform())}),window.addEventListener("mouseup",()=>this.isDragging=!1),window.addEventListener("resize",()=>this.updateTransform())}createSVGElement(t,e={}){const n=document.createElementNS("http://www.w3.org/2000/svg",t);return Object.entries(e).forEach(([t,e])=>n.setAttribute(t,e)),n}updateTransform(){this.querySelector("#workplace-content").setAttribute("transform",`translate(${this.offsetX},${this.offsetY}) scale(${this.scale})`),this.updateGrid(),this.updateRulers()}updateGrid(){const t=this.querySelector("#grid");if(!t)return;var e=this.gridSize*this.scale;e*=this.scale>=.5?2.5:5;const n=this.offsetX%e,r=this.offsetY%e;t.setAttribute("width",e),t.setAttribute("height",e),t.setAttribute("x",n),t.setAttribute("y",r),t.querySelector("path").setAttribute("d",`M ${e} 0 L 0 0 0 ${e}`)}updateRulers(){const t=this.querySelector(".ruler-x"),e=this.querySelector(".ruler-y");if(!t||!e)return;const n=this.querySelector(".workplace"),{width:r,height:s}=n.getBoundingClientRect();this.updateRulerX(t,r),this.updateRulerY(e,s)}updateRulerX(t,e){const n=this.getOptimalStep(),r=n*this.scale,s=-this.offsetX/this.scale,o=Math.floor(s/n)*n;t.innerHTML="";for(let s=o;s*this.scale+this.offsetX<e+r;s+=n){const n=s*this.scale+this.offsetX;if(n>=-r&&n<=e+r){const e=document.createElement("div");e.className="ruler-tick ruler-tick-x",e.style.left=`${n}px`;const r=document.createElement("div");r.className="ruler-label ruler-label-x",r.style.left=`${n}px`,r.textContent=Math.round(s),t.appendChild(e),t.appendChild(r)}}}updateRulerY(t,e){const n=this.getOptimalStep(),r=n*this.scale,s=-this.offsetY/this.scale,o=Math.floor(s/n)*n;t.innerHTML="";for(let s=o;s*this.scale+this.offsetY<e+r;s+=n){const n=s*this.scale+this.offsetY;if(n>=-r&&n<=e+r){const e=document.createElement("div");e.className="ruler-tick ruler-tick-y",e.style.top=`${n}px`;const r=document.createElement("div");r.className="ruler-label ruler-label-y",r.style.top=`${n}px`,r.textContent=Math.round(s),t.appendChild(e),t.appendChild(r)}}}getOptimalStep(){const t=50*this.scale;return t>50?50:t>25?100:t>10?200:400}movePolygon(t){const e=t.target,n=this.querySelector(".workplace").getBoundingClientRect(),[r,s]=[t.clientX,t.clientY];var o,i;const a=e.getAttribute("transform")||"";let[l,c]=this.getTranslateValue(a);const d=t=>{o=l+(t.clientX-r)/this.scale,i=t.clientY<n.y?i:c+(t.clientY-s)/this.scale,e.setAttribute("transform",`translate(${o},${i})`)},u=()=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",u)};window.addEventListener("mousemove",d),window.addEventListener("mouseup",u)}}customElements.get("work-place")||customElements.define("work-place",t)},919:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(601),s=n.n(r),o=n(314),i=n.n(o)()(s());i.push([t.id,":root {\n    --primary-text-color: rgb(34, 34, 34);\n    --secondary-text-color: rgba(204, 204, 204, 0.5);\n    --button-color: rgb(131, 209, 255);\n    --success-text-color: rgb(0, 37, 6);\n    --success-background-color: rgb(131, 255, 152);\n    --background-color: rgb(56, 56, 56);\n    --outline-color: rgb(0, 204, 255);\n    --grid-color: rgba(233, 233, 233, 0.5);\n    --ruler-background-color: rgb(78, 78, 78);\n\n    --ruler-size: 24px;\n    --tick-size: calc(var(--ruler-size) / 3);\n    --tick-spacing: calc(var(--tick-size) * 2);\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100vh;\n    gap: 2px;\n}\n\nheader {\n    display: inline-flex;\n    padding: 8px 16px;\n    gap: 16px;\n    background-color: var(--background-color);\n\n    button {\n        padding: 8px 12px;\n        background-color: var(--button-color);\n        border: none;\n        border-radius: 4px;\n        cursor: pointer;\n        transition: 0.2s ease opacity;\n    }\n\n    button:hover {\n        opacity: 0.6;\n    }\n\n    button:active {\n        opacity: 0.4;\n    }\n\n    button.success {\n        background-color: var(--success-background-color);\n        color: var(--success-text-color);\n        opacity: 1;\n    }\n\n    #save-polygons {\n        margin-left: auto;\n    }\n}\n\nmain {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    gap: inherit;\n}\n\n.buffer,\nwork-place {\n    position: relative;\n    width: 100%;\n    background-color: var(--background-color);\n    user-select: none;\n    transition: 0.2s ease;\n    transition-property: filter;\n}\n\n.buffer {\n    display: flex;\n    flex-wrap: wrap;\n    align-content: flex-start;\n    align-items: center;\n    height: 30%;\n    padding: 8px 16px;\n    resize: vertical;\n    overflow: auto;\n}\n\npolygon-item {\n    display: flex;\n    background-color: transparent;\n}\n\n.dragenter {\n    cursor: copy;\n    filter: brightness(0.6);\n}\n\n.draggable {\n    cursor: grab;\n    color: transparent;\n}\n\n.draggable:hover {\n    color: var(--outline-color);\n}\n\n.draggable:active {\n    cursor: grabbing;\n    color: transparent;\n}\n",""]);const a=i}},e={};function n(r){var s=e[r];if(void 0!==s)return s.exports;var o=e[r]={id:r,exports:{}};return t[r](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{"use strict";var t=n(72),e=n.n(t),r=n(825),s=n.n(r),o=n(659),i=n.n(o),a=n(56),l=n.n(a),c=n(540),d=n.n(c),u=n(113),h=n.n(u),p=n(919),g={};g.styleTagTransform=h(),g.setAttributes=l(),g.insert=i().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=d(),e()(p.A,g),p.A&&p.A.locals&&p.A.locals;var f=n(16),m={};m.styleTagTransform=h(),m.setAttributes=l(),m.insert=i().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=d(),e()(f.A,m),f.A&&f.A.locals&&f.A.locals,n(583),n(870);const v=document.querySelector(".buffer"),b=document.getElementById("create-polygons"),y=document.getElementById("save-polygons"),w=document.getElementById("reset-polygons");var x,E;window.getRandomInt=(t,e)=>Math.floor(Math.random()*(e-t+1))+t,window.randomColor=()=>`hsl(${Math.floor(360*Math.random())}, ${40+20*Math.random()}%, ${60+15*Math.random()}%)`,window.addEventListener("mousedown",t=>{const e=t.target;"polygon"===e.tagName&&e.dataset.id&&(x=!0,E=e.dataset.id)}),window.addEventListener("mouseup",()=>{if(v.classList.contains("dragenter")&&E){const t=document.querySelector(`#workplace-content polygon[data-id="${E}"]`);if(t){const e=document.createElement("polygon-item");t.removeAttribute("transform"),t.removeAttribute("data-id"),t.removeAttribute("class"),e.id=E,e.appendChild(t),v.appendChild(e)}}E=null,x=!1,v.classList.remove("dragenter")}),v.addEventListener("mouseenter",t=>{x&&v.classList.add("dragenter")}),v.addEventListener("mouseleave",()=>{v.classList.remove("dragenter")});const k=(t,e,n=500)=>{if(!t)return;let r=t.textContent;t.textContent=e,t.classList.add("success"),t.disabled=!0,setTimeout(()=>{t.textContent=r,t.classList.remove("success"),t.removeAttribute("disabled")},n)};b.addEventListener("click",()=>(()=>{v.innerHTML="";const t=getRandomInt(5,20);for(let e=0;e<t;e++){const t=document.createElement("polygon-item");v.appendChild(t)}k(b,"Создано")})()),y.addEventListener("click",()=>(()=>{const t=document.getElementById("workplace-content");if(!t)return;const e=[...t.querySelectorAll("polygon")].map(t=>({points:t.getAttribute("points"),fill:t.getAttribute("fill"),transform:t.getAttribute("transform"),dataId:t.getAttribute("data-id")})),n={transform:t.getAttribute("transform"),polygons:e};localStorage.setItem("workplace-data",JSON.stringify(n)),k(y,"Сохранено")})()),w.addEventListener("click",()=>(()=>{const t=document.getElementById("workplace-content");t&&(t.innerHTML="",v.innerHTML="",localStorage.clear(),k(w,"Сброшено"))})())})()})();